#include "ShapeFunction.h"




shapeFunction ShapeFunction(double s, double t) {
	shapeFunction sf;
	
	sf.fun = {
		0.25 * (1.0 + s) * (1.0 + t) * (s + t - 1.0),
		0.25 * (1.0 + s) * (1.0 - t) * (s - t - 1.0),
		0.25 * (1.0 - s) * (1.0 - t) * (-s - t - 1.0),
		0.25 * (1.0 - s) * (1.0 + t) * (-s + t - 1.0),
		0.5 * (1.0 + s) * (1.0 - t * t),
		0.5 * (1.0 - s * s) * (1.0 - t),
		0.5 * (1.0 - s) * (1.0 - t * t),
		0.5 * (1.0 - s * s) * (1.0 + t)


	};
	

	sf.dfun ={
		{
		   0.25 * ((1.0 + t) * (s + t - 1.0) + (1.0 + s + t + s * t)),
		   0.25 * ((1.0 + s) * (s + t - 1.0) + (1.0 + s + t + s * t)),
		},

		{
		   0.25 * ((1.0 - t) * (s - t - 1.0) + (1.0 + s - t - s * t)),
		   0.25 * ((-1.0 - s) * (s - t - 1.0) - (1.0 + s - t - s * t)),
		},

		{
		    0.25 * ((-1.0 + t) * (-s - t - 1.0) - (1.0 - s - t + s * t)),
		    0.25 * ((-1.0 + s) * (-s - t - 1.0) - (1.0 - s - t + s * t)),
		},
		{
		    0.25 * ((-1.0 - t) * (-s + t - 1.0) - (1.0 - s + t - s * t)),
		    0.25 * ((1.0 - s) * (-s + t - 1.0) + (1.0 - s + t - s * t)),
		},
		{
		    0.5 * (1.0 - t * t),
		    -t * (1.0 + s),
		},
		{
		    -s * (1.0 - t),
		    -0.5 * (1.0 - s * s),
		},
		{
		    -0.5 * (1.0 - t * t),
		    -t * (1.0 - s),
		},
		{
		    -s * (1.0 + t),
		    0.5 * (1.0 - s * s)
		}
};
	



	
	return sf;


}